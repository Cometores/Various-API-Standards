{
  "info": {
    "_postman_id": "9a2f8f91-93ef-4ca5-be1b-d2ce559e39ee",
    "name": "Minimal API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "14906710"
  },
  "item": [
    {
      "name": "401 Unauthorized",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 401 (Unathorized)\", () => pm.response.to.have.status(401));"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "auth": {
          "type": "noauth"
        },
        "method": "GET",
        "header": [
          {
            "key": "",
            "value": "",
            "type": "text",
            "disabled": true
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/dishes",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dishes",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () =>  pm.response.to.have.status(200));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.ok;\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "pm.test(\"Response is an array\", () => {\r",
              "    pm.expect(json).to.be.an(\"array\");\r",
              "});\r",
              "\r",
              "pm.test(\"Array is not empty\", () => {\r",
              "    pm.expect(json.length).to.be.greaterThan(0);\r",
              "});\r",
              "\r",
              "// RFC 4122 GUID regex (v1-v5)\r",
              "const guidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\r",
              "\r",
              "pm.test(\"Each item has Dish properties and valid values\", () => {\r",
              "    json.forEach((dish, i) => {\r",
              "        pm.expect(dish, `item[${i}]`).to.be.an(\"object\");\r",
              "        pm.expect(dish, `item[${i}]`).to.have.property(\"id\");\r",
              "        pm.expect(dish, `item[${i}]`).to.have.property(\"name\");\r",
              "\r",
              "        pm.expect(dish.id, `item[${i}].id`).to.be.a(\"string\");\r",
              "        pm.expect(dish.id, `item[${i}].id`).to.match(guidRegex);\r",
              "\r",
              "        pm.expect(dish.name, `item[${i}].name`).to.be.a(\"string\");\r",
              "        pm.expect(dish.name.trim(), `item[${i}].name`).to.not.equal(\"\");\r",
              "    });\r",
              "});"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "",
            "value": "",
            "type": "text",
            "disabled": true
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/dishes",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => pm.response.to.have.status(200));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.ok;\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "// RFC 4122 GUID regex (v1-v5)\r",
              "const guidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\r",
              "\r",
              "pm.test(\"Response has Dish properties\", () => {\r",
              "    pm.expect(json).to.be.an(\"object\");\r",
              "    pm.expect(json).to.have.property(\"id\");\r",
              "    pm.expect(json).to.have.property(\"name\");\r",
              "});\r",
              "\r",
              "pm.test(\"Dish fields are valid\", () => {\r",
              "    pm.expect(json.id).to.be.a(\"string\").and.match(guidRegex);\r",
              "    pm.expect(json.name).to.be.a(\"string\");\r",
              "    pm.expect(json.name.trim()).to.not.equal(\"\");\r",
              "});\r",
              "\r",
              "pm.test(\"Dish id matches requested id\", () => {\r",
              "    pm.expect(json.id).to.equal(\"fd630a57-2352-4731-b25c-db9cc7601b16\");\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/dishes/fd630a57-2352-4731-b25c-db9cc7601b16",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "fd630a57-2352-4731-b25c-db9cc7601b16"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish (by name)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => pm.response.to.have.status(200));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.ok;\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "const requestedName = pm.request.url.path[pm.request.url.path.length - 1];\r",
              "\r",
              "// RFC 4122 GUID regex (v1-v5)\r",
              "const guidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\r",
              "\r",
              "pm.test(\"Response has Dish properties\", () => {\r",
              "    pm.expect(json).to.be.an(\"object\");\r",
              "    pm.expect(json).to.have.property(\"id\");\r",
              "    pm.expect(json).to.have.property(\"name\");\r",
              "});\r",
              "\r",
              "pm.test(\"Dish fields are valid\", () => {\r",
              "    pm.expect(json.id).to.be.a(\"string\").and.match(guidRegex);\r",
              "    pm.expect(json.name).to.be.a(\"string\").and.not.equal(\"\");\r",
              "});\r",
              "\r",
              "pm.test(\"Dish name matches requested name\", () => {\r",
              "    pm.expect(json.name).to.equal(requestedName);\r",
              "});"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/dishes/Rendang",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "Rendang"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dishes (filtered)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => pm.response.to.have.status(200));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.ok;\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "const nameFilter = (pm.request.url.query.get(\"name\") || \"\").trim();\r",
              "\r",
              "pm.test(\"Query param 'name' is provided\", () => {\r",
              "    pm.expect(nameFilter).to.not.equal(\"\");\r",
              "});\r",
              "\r",
              "pm.test(\"Response is an array\", () => {\r",
              "    pm.expect(json).to.be.an(\"array\");\r",
              "});\r",
              "\r",
              "// RFC 4122 GUID regex (v1-v5)\r",
              "const guidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\r",
              "\r",
              "pm.test(\"Each item has Dish properties and valid values\", () => {\r",
              "    json.forEach((dish, i) => {\r",
              "        pm.expect(dish, `item[${i}]`).to.have.property(\"id\");\r",
              "        pm.expect(dish, `item[${i}]`).to.have.property(\"name\");\r",
              "\r",
              "        pm.expect(dish.id, `item[${i}].id`).to.be.a(\"string\").and.match(guidRegex);\r",
              "        pm.expect(dish.name, `item[${i}].name`).to.be.a(\"string\").and.not.equal(\"\");\r",
              "    });\r",
              "});\r",
              "\r",
              "pm.test(\"Filtering by name works (every item matches filter)\", () => {\r",
              "    const expected = nameFilter.toLowerCase();\r",
              "\r",
              "    json.forEach((dish, i) => {\r",
              "        const actual = String(dish.name ?? \"\").toLowerCase();\r",
              "        pm.expect(actual, `item[${i}].name should contain '${nameFilter}'`).to.include(expected);\r",
              "    });\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/dishes?name=Mussels",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes"
          ],
          "query": [
            {
              "key": "name",
              "value": "Mussels"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish (404 not found)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 404\", () => pm.response.to.have.status(404));"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/dishes/b539b05a-4c49-44b4-98fc-3b072d5fd3f8",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "b539b05a-4c49-44b4-98fc-3b072d5fd3f8"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 201 (Created)\", () => pm.response.to.have.status(201));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "// RFC 4122 GUID regex (v1-v5)\r",
              "const guidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\r",
              "\r",
              "pm.test(\"Response has Dish properties and valid values\", () => {\r",
              "    pm.expect(json).to.be.an(\"object\");\r",
              "    pm.expect(json).to.have.property(\"id\");\r",
              "    pm.expect(json).to.have.property(\"name\");\r",
              "\r",
              "    pm.expect(json.id).to.be.a(\"string\").and.match(guidRegex);\r",
              "    pm.expect(json.name).to.be.a(\"string\");\r",
              "    pm.expect(json.name.trim()).to.not.equal(\"\");\r",
              "});\r",
              "\r",
              "const requestBody = pm.request.body?.raw ? JSON.parse(pm.request.body.raw) : null;\r",
              "\r",
              "pm.test(\"Response name matches request payload\", () => {\r",
              "    pm.expect(requestBody).to.not.equal(null);\r",
              "    pm.expect(requestBody).to.have.property(\"name\");\r",
              "    pm.expect(json.name).to.equal(requestBody.name);\r",
              "});\r",
              "\r",
              "// ---- Location header checks ----\r",
              "pm.test(\"Location header exists\", () => {\r",
              "    pm.expect(pm.response.headers.has(\"Location\")).to.be.true;\r",
              "});\r",
              "\r",
              "/// Build expected Location without unresolved {{...}} placeholders.\r",
              "const rawBaseUrl =\r",
              "    pm.collectionVariables.get(\"baseUrl\") ||\r",
              "    pm.environment.get(\"baseUrl\") ||\r",
              "    \"\";\r",
              "\r",
              "// If baseUrl still contains {{...}}, rebuild it using portNumber\r",
              "const resolvedBaseUrl = (rawBaseUrl && !rawBaseUrl.includes(\"{{\"))\r",
              "    ? rawBaseUrl\r",
              "    : (() => {\r",
              "        const port = pm.variables.get(\"portNumber\");\r",
              "        pm.expect(port, \"portNumber\").to.not.equal(undefined);\r",
              "        pm.expect(String(port), \"portNumber\").to.match(/^\\d+$/);\r",
              "        return `http://localhost:${port}`;\r",
              "    })();\r",
              "\r",
              "const expectedLocation = `${resolvedBaseUrl}/dishes/${json.id}`;\r",
              "\r",
              "pm.test(\"Location header points to the created resource\", () => {\r",
              "    const location = pm.response.headers.get(\"Location\");\r",
              "    pm.expect(location, \"Location header value\").to.be.a(\"string\").and.not.equal(\"\");\r",
              "    pm.expect(location).to.equal(expectedLocation);\r",
              "});\r",
              "\r",
              "pm.collectionVariables.set(\"createdDishId\", json.id);\r",
              "\r",
              "pm.test(\"Created dish id is saved to collection variable\", () => {\r",
              "    pm.expect(pm.collectionVariables.get(\"createdDishId\")).to.equal(json.id);\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n    \"name\": \"Pizza Hawaii\"\r\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/dishes",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish (invalid - name too short))",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400 (Bad Request)\", () => pm.response.to.have.status(400));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "pm.test(\"Validation ProblemDetails shape is present\", () => {\r",
              "    pm.expect(json).to.have.property(\"type\");\r",
              "    pm.expect(json).to.have.property(\"title\");\r",
              "    pm.expect(json).to.have.property(\"status\", 400);\r",
              "    pm.expect(json).to.have.property(\"errors\");\r",
              "});\r",
              "\r",
              "pm.test(\"Validation errors contain Name\", () => {\r",
              "    pm.expect(json.errors).to.be.an(\"object\");\r",
              "    pm.expect(json.errors).to.have.property(\"Name\");\r",
              "    pm.expect(json.errors.Name).to.be.an(\"array\").and.not.empty;\r",
              "});\r",
              "\r",
              "pm.test(\"Name validation message matches expectations\", () => {\r",
              "    const combined = json.errors.Name.join(\" | \");\r",
              "    pm.expect(combined).to.include(\"Name\");\r",
              "    pm.expect(combined).to.include(\"minimum length of 3\");\r",
              "    pm.expect(combined).to.include(\"maximum length of 100\");\r",
              "});\r",
              "\r",
              "pm.test(\"ProblemDetails metadata is correct\", () => {\r",
              "    pm.expect(String(json.type)).to.include(\"rfc7231\");\r",
              "    pm.expect(String(json.type)).to.include(\"6.5.1\");\r",
              "    pm.expect(json.title).to.equal(\"One or more validation errors occurred.\");\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n    \"name\": \"A\"\r\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/dishes",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish (invalid - name null)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400 (Bad Request)\", () => pm.response.to.have.status(400));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "pm.test(\"Validation ProblemDetails shape is present\", () => {\r",
              "    pm.expect(json).to.have.property(\"type\");\r",
              "    pm.expect(json).to.have.property(\"title\");\r",
              "    pm.expect(json).to.have.property(\"status\", 400);\r",
              "    pm.expect(json).to.have.property(\"errors\");\r",
              "});\r",
              "\r",
              "pm.test(\"Validation errors contain Name\", () => {\r",
              "    pm.expect(json.errors).to.be.an(\"object\");\r",
              "    pm.expect(json.errors).to.have.property(\"Name\");\r",
              "    pm.expect(json.errors.Name).to.be.an(\"array\").and.not.empty;\r",
              "});\r",
              "\r",
              "pm.test(\"Name required validation message matches expectations\", () => {\r",
              "    const combined = json.errors.Name.join(\" | \");\r",
              "    pm.expect(combined).to.include(\"The Name field is required.\");\r",
              "});\r",
              "\r",
              "pm.test(\"ProblemDetails metadata is correct\", () => {\r",
              "    pm.expect(String(json.type)).to.include(\"rfc7231\");\r",
              "    pm.expect(String(json.type)).to.include(\"6.5.1\");\r",
              "    pm.expect(json.title).to.equal(\"One or more validation errors occurred.\");\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n    \"name\": null\r\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/dishes",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 204 (No Content)\", () => pm.response.to.have.status(204));\r",
              "\r",
              "const portNumber = pm.variables.get(\"portNumber\"); // must be numeric, e.g. 5001\r",
              "const dishId = pm.collectionVariables.get(\"createdDishId\");\r",
              "\r",
              "pm.test(\"portNumber and createdDishId are set\", () => {\r",
              "    pm.expect(String(portNumber), \"portNumber\").to.match(/^\\d+$/);\r",
              "    pm.expect(dishId, \"createdDishId\").to.be.a(\"string\").and.not.equal(\"\");\r",
              "});\r",
              "\r",
              "// Read Authorization header from the current PUT request (Bearer token)\r",
              "const authHeader = pm.request.headers.get(\"Authorization\");\r",
              "\r",
              "pm.test(\"PUT request has Authorization header\", () => {\r",
              "    pm.expect(authHeader, \"Authorization header\").to.be.a(\"string\").and.not.equal(\"\");\r",
              "    pm.expect(authHeader.toLowerCase()).to.match(/^bearer\\s+\\S+/);\r",
              "});\r",
              "\r",
              "// Expected value comes from the PUT request payload (no need to validate the payload itself)\r",
              "const expectedName = JSON.parse(pm.request.body.raw).name;\r",
              "\r",
              "// Build an absolute URL without unresolved {{...}} placeholders\r",
              "const verifyUrl = `http://localhost:${portNumber}/dishes/${dishId}`;\r",
              "\r",
              "pm.sendRequest(\r",
              "  {\r",
              "    url: verifyUrl,\r",
              "    method: \"GET\",\r",
              "    header: {\r",
              "      \"Accept\": \"application/json\",\r",
              "      \"Authorization\": authHeader\r",
              "    }\r",
              "  },\r",
              "  function (err, res) {\r",
              "\r",
              "    // First: ensure the follow-up request actually executed\r",
              "    pm.test(\"Follow-up GET executed\", () => {\r",
              "        pm.expect(err, `GET failed. url=${verifyUrl}`).to.equal(null);\r",
              "        pm.expect(res, \"Response object is missing\").to.not.equal(undefined);\r",
              "    });\r",
              "\r",
              "    if (err || !res) return;\r",
              "\r",
              "    pm.test(\"Follow-up GET succeeded (200)\", () => {\r",
              "        pm.expect(res.code).to.equal(200);\r",
              "    });\r",
              "\r",
              "    const json = res.json();\r",
              "\r",
              "    pm.test(\"Dish name was updated\", () => {\r",
              "        pm.expect(String(json.id)).to.equal(String(dishId));\r",
              "        pm.expect(json.name).to.equal(expectedName);\r",
              "    });\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n    \"name\": \"Updated Dish\"\r\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/dishes/{{createdDishId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "{{createdDishId}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish (Cannot update perfection)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400 (Bad Request)\", () => pm.response.to.have.status(400));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "pm.test(\"ProblemDetails shape is present\", () => {\r",
              "    pm.expect(json).to.have.property(\"type\");\r",
              "    pm.expect(json).to.have.property(\"title\");\r",
              "    pm.expect(json).to.have.property(\"status\", 400);\r",
              "    pm.expect(json).to.have.property(\"detail\");\r",
              "});\r",
              "\r",
              "pm.test(\"ProblemDetails content matches the endpoint filter response\", () => {\r",
              "    pm.expect(json.type).to.include(\"rfc7231\");\r",
              "    pm.expect(json.type).to.include(\"6.5.1\");\r",
              "\r",
              "    pm.expect(json.title).to.equal(\"Dish is perfect and cannot be changed.\");\r",
              "    pm.expect(json.detail).to.equal(\"You cannot update or delete perfection.\");\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json",
            "type": "text"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\r\n    \"name\": \"Updated Dish\"\r\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/dishes/fd630a57-2352-4731-b25c-db9cc7601b16",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "fd630a57-2352-4731-b25c-db9cc7601b16"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 204 (No Content)\", () => pm.response.to.have.status(204));\r",
              "\r",
              "const portNumber = pm.variables.get(\"portNumber\");\r",
              "const dishId = pm.collectionVariables.get(\"createdDishId\");\r",
              "\r",
              "pm.test(\"portNumber and createdDishId are set\", () => {\r",
              "    pm.expect(String(portNumber), \"portNumber\").to.match(/^\\d+$/);\r",
              "    pm.expect(dishId, \"createdDishId\").to.be.a(\"string\").and.not.equal(\"\");\r",
              "});\r",
              "\r",
              "// Reuse Authorization header from the current DELETE request (Bearer token)\r",
              "const authHeader = pm.request.headers.get(\"Authorization\");\r",
              "\r",
              "pm.test(\"DELETE request has Authorization header\", () => {\r",
              "    pm.expect(authHeader, \"Authorization header\").to.be.a(\"string\").and.not.equal(\"\");\r",
              "    pm.expect(authHeader.toLowerCase()).to.match(/^bearer\\s+\\S+/);\r",
              "});\r",
              "\r",
              "// Build an absolute URL without unresolved {{...}} placeholders\r",
              "const verifyUrl = `http://localhost:${portNumber}/dishes/${dishId}`;\r",
              "// If your API uses HTTPS, switch to:\r",
              "// const verifyUrl = `https://localhost:${portNumber}/dishes/${dishId}`;\r",
              "\r",
              "pm.sendRequest(\r",
              "  {\r",
              "    url: verifyUrl,\r",
              "    method: \"GET\",\r",
              "    header: {\r",
              "      \"Accept\": \"application/json\",\r",
              "      \"Authorization\": authHeader\r",
              "    }\r",
              "  },\r",
              "  function (err, res) {\r",
              "\r",
              "    // Ensure the follow-up request executed\r",
              "    pm.test(\"Follow-up GET executed\", () => {\r",
              "        pm.expect(err, `GET failed. url=${verifyUrl}`).to.equal(null);\r",
              "        pm.expect(res, \"Response object is missing\").to.not.equal(undefined);\r",
              "    });\r",
              "\r",
              "    if (err || !res) return;\r",
              "\r",
              "    // After deletion, the resource should not be found\r",
              "    pm.test(\"Resource is deleted (GET returns 404)\", () => {\r",
              "        pm.expect(res.code).to.equal(404);\r",
              "    });\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "",
            "value": "",
            "type": "text",
            "disabled": true
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "url": {
          "raw": "{{baseUrl}}/dishes/{{createdDishId}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "{{createdDishId}}"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish (400 is perfect)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400 (Bad Request)\", () => pm.response.to.have.status(400));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "pm.test(\"ProblemDetails shape is present\", () => {\r",
              "    pm.expect(json).to.have.property(\"type\");\r",
              "    pm.expect(json).to.have.property(\"title\");\r",
              "    pm.expect(json).to.have.property(\"status\", 400);\r",
              "    pm.expect(json).to.have.property(\"detail\");\r",
              "});\r",
              "\r",
              "pm.test(\"ProblemDetails content matches the endpoint filter response\", () => {\r",
              "    pm.expect(String(json.type)).to.include(\"rfc7231\");\r",
              "    pm.expect(String(json.type)).to.include(\"6.5.1\");\r",
              "\r",
              "    pm.expect(json.title).to.equal(\"Dish is perfect and cannot be changed.\");\r",
              "    pm.expect(json.detail).to.equal(\"You cannot update or delete perfection.\");\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "",
            "value": "",
            "type": "text",
            "disabled": true
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "url": {
          "raw": "{{baseUrl}}/dishes/fd630a57-2352-4731-b25c-db9cc7601b16",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "fd630a57-2352-4731-b25c-db9cc7601b16"
          ]
        }
      },
      "response": []
    },
    {
      "name": "Dish (404 not found)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 404 (Not Found)\", () => pm.response.to.have.status(404));"
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "",
            "value": "",
            "type": "text",
            "disabled": true
          }
        ],
        "body": {
          "mode": "raw",
          "raw": ""
        },
        "url": {
          "raw": "{{baseUrl}}/dishes/e6c79d8c-8ab1-4b88-ab17-b008e21e053e",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "e6c79d8c-8ab1-4b88-ab17-b008e21e053e"
          ]
        }
      },
      "response": []
    },
    {
      "name": "GET Ingredients",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", () => pm.response.to.have.status(200));\r",
              "\r",
              "pm.test(\"Response must be JSON with a body\", () => {\r",
              "    pm.response.to.be.withBody;\r",
              "    pm.response.to.be.json;\r",
              "});\r",
              "\r",
              "const json = pm.response.json();\r",
              "\r",
              "pm.test(\"Response is an array\", () => {\r",
              "    pm.expect(json).to.be.an(\"array\");\r",
              "});\r",
              "\r",
              "pm.test(\"Array is not empty\", () => {\r",
              "    pm.expect(json.length).to.be.greaterThan(0);\r",
              "});\r",
              "\r",
              "// RFC 4122 GUID regex (v1-v5)\r",
              "const guidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;\r",
              "\r",
              "// Dish id is the last segment before \"ingredients\"\r",
              "const path = pm.request.url.path;\r",
              "const dishIdFromPath = path[path.length - 2]; // .../{dishId}/ingredients\r",
              "\r",
              "pm.test(\"Dish id in URL is a valid GUID\", () => {\r",
              "    pm.expect(dishIdFromPath).to.match(guidRegex);\r",
              "});\r",
              "\r",
              "pm.test(\"Each item has Ingredient properties and matches the dishId\", () => {\r",
              "    json.forEach((ing, i) => {\r",
              "        pm.expect(ing, `item[${i}]`).to.be.an(\"object\");\r",
              "        pm.expect(ing, `item[${i}]`).to.have.property(\"id\");\r",
              "        pm.expect(ing, `item[${i}]`).to.have.property(\"name\");\r",
              "        pm.expect(ing, `item[${i}]`).to.have.property(\"dishId\");\r",
              "\r",
              "        pm.expect(ing.id, `item[${i}].id`).to.be.a(\"string\").and.match(guidRegex);\r",
              "        pm.expect(ing.name, `item[${i}].name`).to.be.a(\"string\");\r",
              "        pm.expect(ing.name.trim(), `item[${i}].name`).to.not.equal(\"\");\r",
              "\r",
              "        pm.expect(ing.dishId, `item[${i}].dishId`).to.be.a(\"string\").and.match(guidRegex);\r",
              "        pm.expect(ing.dishId, `item[${i}].dishId should equal requested dishId`).to.equal(dishIdFromPath);\r",
              "    });\r",
              "});\r",
              ""
            ],
            "type": "text/javascript",
            "packages": {},
            "requests": {}
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/dishes/fd630a57-2352-4731-b25c-db9cc7601b16/ingredients",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "dishes",
            "fd630a57-2352-4731-b25c-db9cc7601b16",
            "ingredients"
          ]
        }
      },
      "response": []
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1bmlxdWVfbmFtZSI6ImFuaWNvIiwic3ViIjoiYW5pY28iLCJqdGkiOiJjYzBiOGYxYyIsInJvbGUiOiJhZG1pbiIsImNvdW50cnkiOiJHZXJtYW55IiwiYXVkIjoiTWluaW1hbEFQSSIsIm5iZiI6MTc3MDk5MjQwNywiZXhwIjoxNzc4NjgyMDA3LCJpYXQiOjE3NzA5OTI0MDgsImlzcyI6ImRvdG5ldC11c2VyLWp3dHMifQ.ZKZZvrCWjNt1T1cBC7aiaAxyLwXhW3Bd5j_Z2s6HeBQ",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "requests": {},
        "exec": [
          ""
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "requests": {},
        "exec": [
          ""
        ]
      }
    }
  ],
  "variable": [
    {
      "key": "portNumber",
      "value": "5080"
    },
    {
      "key": "baseUrl",
      "value": ""
    },
    {
      "key": "createdDishId",
      "value": ""
    }
  ]
}